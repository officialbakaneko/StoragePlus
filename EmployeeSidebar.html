<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <h4>Select Your Name</h4>
    <div id="employee-buttons-container"><!-- container for employee buttons --> </div>

    <script>
      // Function to handle button clicks
      function buttonClicked(e) {
        var buttonId = e.target.id;
        google.script.run.processButtonClick(buttonId);
      }

      // Function to create employee buttons
      function createEmployeeButtons(employeeList) {
        var container = document.getElementById("employee-buttons-container");

        employeeList.forEach(function(employeeObj) {
          var button = document.createElement("button");
          button.textContent = employeeObj.name;
          button.id = employeeObj.admin ? "admin" : "employee";
          button.className = employeeObj.temporary ? "temporary" : "permanent";
          button.addEventListener("click", buttonClicked);
          container.appendChild(button);
        });

        var button = document.createElement("button");
        button.textContent = "Other";
        button.id = "other";
        button.addEventListener("click", buttonClicked);
        container.appendChild(button);
      }

      // Load the employee list and create buttons
      google.script.run.withSuccessHandler(createEmployeeButtons).getEmployeeList();
    </script>
  </body>
</html>
